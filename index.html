<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript">
		"use strict";
		class Observer {
		}
		class Subject {
			constructor() {
				this.observers = [];
			}
			attach(observer) {
				this.observers.push(observer);
			}
			detach(observer) {
				this.observers = this.observers.filter(o => o !== observer);
			}
			notify() {
				for (const observer of this.observers) {
					observer.update(this);
				}
			}
		}
		class ClockTimer extends Subject {
			constructor() {
				super();
				this.updateInterval = 1000;
				this.hours = (new Date()).getHours();
				this.minutes = (new Date()).getMinutes();
				this.seconds = (new Date()).getSeconds();
			}
			start() {
				setInterval(() => this.tick(), this.updateInterval);
			}
			tick() {
				this.seconds++;
				if (this.seconds > 59) {
					this.seconds = 0;
					this.minutes++;
					if (this.minutes > 59) {
						this.minutes = 0;
						this.hours++;
						if (this.hours > 23) {
							this.hours = 0;
						}
					}
				}
				this.notify();
			}
			getHours() {
				return this.hours;
			}
			getMinutes() {
				return this.minutes;
			}
			getSeconds() {
				return this.seconds;
			}
		}
		class Thermometer extends Subject {
			constructor() {
				super();
				this.updateInterval = 4000;
				this.temperature = this.getTemperature();
			}
			start() {
				setInterval(() => this.tick(), this.updateInterval);
			}
			tick() {
				this.temperature = this.getTemperature();
				this.notify();
			}
			getTemperature() {
				const now = new Date();
				const hourWithFractions = now.getHours() + now.getMinutes() / 60 + now.getSeconds() / 3600;
				return this.temperatureFunction(hourWithFractions);
			}
			temperatureFunction(hourWithFractions) {
				const x = hourWithFractions;
				const temperature = 10
						+ 2 * (-4 * Math.sin(0.3 * x) - Math.sin(-2.5 * Math.E * x) + 2 * Math.sin(-0.3 * Math.PI * x))
						- 10 * Math.sin(x / 100);
				return this.roundBy(temperature, 2);
			}
			roundBy(num, digits) {
				const multiplier = Math.pow(10, digits);
				return Math.round(num * multiplier) / multiplier;
			}
		}
		class Clock {
			constructor() {
				this.hours = 0;
				this.minutes = 0;
				this.seconds = 0;
			}
			draw() {
				console.log(`Drew clock with a time of ${this.padded(this.hours)}:${this.padded(this.minutes)}:${this.padded(this.seconds)}.`);
			}
			padded(num) {
				let s = String(num);
				while (s.length < 2) {
					s = "0" + s;
				}
				return s;
			}
		}
		class DigitalClockWithTemperature extends Clock {
			constructor(timer, thermometer) {
				super();
				this.timer = timer;
				timer.attach(this);
				this.thermometer = thermometer;
				thermometer.attach(this);
				this.hours = timer.getHours();
				this.minutes = timer.getMinutes();
				this.seconds = timer.getSeconds();
				this.temperature = thermometer.getTemperature();
				this.draw();
			}
			update(subject) {
				if (subject === this.timer) {
					const timer = subject;
					this.hours = timer.getHours();
					this.minutes = timer.getMinutes();
					this.seconds = timer.getSeconds();
				}
				else if (subject === this.thermometer) {
					const thermometer = subject;
					this.temperature = thermometer.getTemperature();
				}
				this.draw();
			}
			draw() {
				console.log(`Drew analog clock with a time of ${this.padded(this.hours)}:${this.padded(this.minutes)}:${this.padded(this.seconds)} and temperature of ${this.temperature} \u2103.`);
			}
		}
		class AnalogClock extends Clock {
			constructor(timer) {
				super();
				this.timer = timer;
				timer.attach(this);
				this.hours = timer.getHours();
				this.minutes = timer.getMinutes();
				this.seconds = timer.getSeconds();
				this.draw();
			}
			update(subject) {
				if (subject === this.timer) {
					const timer = subject;
					this.hours = timer.getHours();
					this.minutes = timer.getMinutes();
					this.seconds = timer.getSeconds();
				}
				this.draw();
			}
			draw() {
				console.log(`Drew analog clock with a time of ${this.padded(this.hours)}:${this.padded(this.minutes)}:${this.padded(this.seconds)}.`);
			}
		}
		const timer = new ClockTimer();
		timer.start();
		const thermometer = new Thermometer();
		thermometer.start();
		new DigitalClockWithTemperature(timer, thermometer);
		new AnalogClock(timer);

	</script>
</head>
<body>

<h1>My First Heading</h1>
<p>My first paragraph.</p>

</body>
</html>
